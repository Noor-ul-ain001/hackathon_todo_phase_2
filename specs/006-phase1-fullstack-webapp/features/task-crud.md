# Feature: Task CRUD Operations

## User Stories

### As a user, I can create a task

**Acceptance Criteria**:
- I can provide a required title (1-200 characters)
- I can optionally provide a description (max 1000 characters)
- The task is immediately visible in my task list
- The task persists across browser sessions
- The task is associated with my user account

### As a user, I can view my tasks

**Acceptance Criteria**:
- I see a list of all my tasks when I open the task dashboard
- Each task displays its title, description, and completion status
- Tasks are presented in a clear, organized format
- I can distinguish between complete and incomplete tasks visually
- The list updates immediately when I create, update, or delete tasks
- I only see tasks that belong to me (data isolation enforced)

### As a user, I can update a task

**Acceptance Criteria**:
- I can edit the title of an existing task
- I can edit the description of an existing task
- Changes are saved immediately
- Changes persist across browser sessions
- I can cancel editing without saving changes
- I can only update my own tasks

### As a user, I can delete a task

**Acceptance Criteria**:
- I can permanently remove a task from my list
- I see a confirmation prompt before deletion to prevent accidents
- Once deleted, the task is removed from the database
- I cannot recover deleted tasks (in Phase 1)
- I can only delete my own tasks

### As a user, I can mark a task complete/incomplete

**Acceptance Criteria**:
- I can toggle a task between complete and incomplete states
- The completion status is visually indicated (e.g., checkmark, strikethrough)
- The status change persists across browser sessions
- I can toggle the status as many times as needed
- The toggle operation is fast and responsive (< 1 second)

## Task Fields

### Required Fields

- **title** (string, 1–200 characters)
  - Purpose: Brief description of what needs to be done
  - Validation: Cannot be empty, max 200 chars
  - Example: "Buy groceries", "Review project proposal"

### Optional Fields

- **description** (string, max 1000 characters)
  - Purpose: Additional details or context about the task
  - Validation: Max 1000 chars, can be null/empty
  - Example: "Need milk, eggs, bread from the store on Main St"

### System Fields (Auto-managed)

- **id** (integer, auto-increment)
  - Purpose: Unique identifier for the task
  - Generated by database, immutable

- **user_id** (string, foreign key)
  - Purpose: Associates task with owner
  - Set automatically from JWT on creation, immutable

- **completed** (boolean, default false)
  - Purpose: Tracks completion status
  - Toggled by user via PATCH endpoint

- **created_at** (timestamp, auto-generated)
  - Purpose: Records when task was created
  - Set automatically by database, immutable

- **updated_at** (timestamp, auto-updated)
  - Purpose: Tracks last modification time
  - Updated automatically by database on any change

## Rules

### Ownership & Isolation
- Tasks MUST belong to a user (user_id is required)
- Users can ONLY access their own tasks
- API MUST verify user_id in URL matches JWT subject
- Cross-user access attempts MUST return 403 Forbidden

### Uniqueness
- Task IDs are unique across the entire system (not per-user)
- Users can have multiple tasks with the same title (no uniqueness constraint on title)

### Validation
- Title is required and must be 1-200 characters
- Description is optional and must be ≤ 1000 characters if provided
- Completed status must be a boolean value

## Acceptance Criteria

### Data Persistence
- Creating a task persists it in the database
- All task fields are correctly stored and retrievable
- Tasks survive server restarts and browser sessions

### Data Isolation
- Listing tasks returns ONLY user-owned tasks
- Attempting to view another user's task returns 404 (as if it doesn't exist)
- Updating/deleting another user's task is forbidden (403 error)

### State Management
- Completion toggle updates task state correctly
- Updated_at timestamp reflects the latest change
- Task updates are atomic (no partial updates)

### Error Handling
- Invalid title length returns clear validation error
- Missing required fields return 400 Bad Request
- Invalid task ID returns 404 Not Found
- Authentication failures return 401 Unauthorized
